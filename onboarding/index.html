<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BotNursery - Onboarding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes confetti {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .step-content {
            animation: fadeIn 0.4s ease-out;
        }
        
        .confetti-piece {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f59e0b;
            animation: confetti 3s ease-out forwards;
            z-index: 1000;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            ring: 2px;
            ring-color: #667eea;
        }
        
        .stripe-input {
            border: 1px solid #e5e7eb;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s;
        }
        
        .stripe-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .plan-card {
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .plan-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .plan-card.selected {
            border: 3px solid #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
        }
        
        .badge {
            position: absolute;
            top: -12px;
            right: -12px;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 500px;
            margin: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .info-icon {
            display: inline-block;
            cursor: pointer;
            color: #667eea;
            font-weight: bold;
            margin-left: 4px;
        }
        
        .info-icon:hover {
            color: #764ba2;
        }
        
        .parsed-field {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .parsed-field .checkmark {
            color: #16a34a;
            margin-right: 8px;
            font-weight: bold;
        }
        
        .parsed-field .value {
            font-family: monospace;
            color: #15803d;
            font-size: 14px;
        }
        
        .callout-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #fbbf24;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Language Toggle -->
    <div class="fixed top-4 right-4 z-50">
        <button id="langToggle" class="bg-white px-4 py-2 rounded-lg shadow-md hover:shadow-lg transition-all text-sm font-medium">
            üá¨üáß English
        </button>
    </div>

    <!-- Progress Bar -->
    <div class="fixed top-0 left-0 right-0 bg-white shadow-md z-40">
        <div class="max-w-4xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between mb-2">
                <div class="flex items-center space-x-2">
                    <span class="text-2xl">ü§±</span>
                    <span class="font-bold text-lg text-gray-800">BotNursery</span>
                </div>
                <div class="text-sm text-gray-600" id="progressText">
                    <span class="lang-pt">Passo 1 de 6</span>
                    <span class="lang-en hidden">Step 1 of 6</span>
                </div>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progressBar" class="gradient-bg h-2 rounded-full transition-all duration-500" style="width: 14.28%"></div>
            </div>
        </div>
    </div>

    <!-- Pricing Info Modal -->
    <div id="pricingModal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold text-gray-800 mb-3">
                <span class="lang-pt">‚ÑπÔ∏è Como funciona a cobran√ßa</span>
                <span class="lang-en hidden">‚ÑπÔ∏è How billing works</span>
            </h3>
            <p class="text-gray-700 mb-4">
                <span class="lang-pt">O custo por paciente, cliente ou aluno se aplica apenas a pacientes, clientes ou alunos que interagem diretamente com o bot via chat. Pacientes que voc√™ atende mas n√£o usam o bot n√£o s√£o cobrados.</span>
                <span class="lang-en hidden">The per-patient, client or student cost applies only to patients, clients or students who interact directly with the bot via chat. Patients you see but don't use the bot are not charged.</span>
            </p>
            <button onclick="closePricingModal()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 rounded-lg transition-all">
                <span class="lang-pt">Entendi!</span>
                <span class="lang-en hidden">Got it!</span>
            </button>
        </div>
    </div>

    <!-- Agreement Modal -->
    <div id="agreementModal" class="modal">
        <div class="bg-white rounded-xl max-w-3xl mx-4 my-8 max-h-[90vh] flex flex-col shadow-2xl" style="width: 95%;">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-t-xl p-6 text-white flex-shrink-0">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-bold">
                        <span class="lang-pt">üìÑ Termos de Servi√ßo ‚Äî BotNursery</span>
                        <span class="lang-en hidden">üìÑ Terms of Service ‚Äî BotNursery</span>
                    </h2>
                    <button onclick="closeAgreementModal()" class="text-white text-2xl hover:opacity-70">&times;</button>
                </div>
            </div>
            <div class="overflow-y-auto p-6 flex-1 text-sm text-gray-700 space-y-6" id="agreementFullText">
                <!-- Section 1 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">1.</span> <span class="lang-pt">Objeto</span><span class="lang-en hidden">Purpose</span></h3>
                    <div class="pl-4 lang-pt">
                        <p>BotNursery fornece uma plataforma de assistente digital alimentada por intelig√™ncia artificial. O assistente √© treinado por voc√™ e para voc√™, refletindo seu conhecimento e abordagem profissional. Opera via Telegram (e futuros canais). O bot representa suas orienta√ß√µes e conhecimento, N√ÉO constitui aconselhamento independente. √â uma ferramenta de apoio ‚Äî a decis√£o profissional final sempre permanece com voc√™.</p>
                    </div>
                    <div class="pl-4 lang-en hidden">
                        <p>BotNursery provides an AI-powered digital assistant platform. The assistant is trained by and for you, reflecting your knowledge and professional approach. Operates via Telegram (and future channels). The bot represents your guidance and knowledge, NOT independent advice. It is a support tool ‚Äî final professional decisions always remain with you.</p>
                    </div>
                </section>
                <!-- Section 2 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">2.</span> <span class="lang-pt">Servi√ßos Inclu√≠dos</span><span class="lang-en hidden">Services Included</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Cria√ß√£o e configura√ß√£o de assistente de IA personalizado</li><li>Treinamento de personalidade e base de conhecimento</li><li>Implanta√ß√£o no Telegram</li><li>Manuten√ß√£o cont√≠nua e atualiza√ß√µes</li><li>Suporte t√©cnico via BotMother e equipe</li><li>Infraestrutura de consentimento para pacientes/clientes</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Custom AI assistant creation and configuration</li><li>Bot personality and knowledge base training</li><li>Telegram deployment</li><li>Ongoing maintenance and updates</li><li>Technical support via BotMother and team</li><li>Patient/client consent form infrastructure</li></ul>
                </section>
                <!-- Section 3 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">3.</span> <span class="lang-pt">Responsabilidades do Profissional</span><span class="lang-en hidden">Professional's Responsibilities</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Fornecer materiais de treinamento precisos</li><li>Revisar e aprovar respostas do bot durante treinamento</li><li>Manter padr√µes profissionais</li><li>Garantir consentimento informado do paciente/cliente</li><li><strong>N√£o substituir</strong> seu julgamento profissional pelo bot</li><li>Manter credenciais seguras</li><li>Reportar erros ou respostas inadequadas</li><li>Cumprir regulamenta√ß√µes aplic√°veis (HIPAA, LGPD)</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Provide accurate training materials</li><li>Review and approve bot responses during training</li><li>Maintain professional standards</li><li>Ensure patient/client informed consent</li><li><strong>Not replace</strong> your professional judgment with the bot</li><li>Keep credentials secure</li><li>Report errors or inappropriate responses</li><li>Comply with applicable regulations (HIPAA, LGPD)</li></ul>
                </section>
                <!-- Section 4 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">4.</span> <span class="lang-pt">Responsabilidades da BotNursery</span><span class="lang-en hidden">BotNursery's Responsibilities</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Manter uptime e seguran√ßa da plataforma</li><li>Proteger dados com criptografia e controles de acesso</li><li><strong>N√ÉO acessar</strong> dados de pacientes exceto para suporte t√©cnico com seu consentimento</li><li>Fornecer atualiza√ß√µes cont√≠nuas</li><li>Notificar sobre incidentes de dados dentro de 48 horas</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Maintain platform uptime and security</li><li>Protect data with encryption and access controls</li><li><strong>NOT access</strong> patient data except for technical support with your consent</li><li>Provide ongoing updates</li><li>Notify of data incidents within 48 hours</li></ul>
                </section>
                <!-- Section 5 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">5.</span> <span class="lang-pt">Dados e Privacidade</span><span class="lang-en hidden">Data & Privacy</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Todos os dados de pacientes/clientes <strong>pertencem a voc√™</strong></li><li>BotNursery processa dados como <strong>operador de dados</strong></li><li>Dados em servidores criptografados (UE)</li><li>Sem compartilhamento com terceiros</li><li>Exporta√ß√£o ou exclus√£o de dados a qualquer momento</li><li>Conformidade LGPD e HIPAA</li><li>Provedores de IA (Anthropic) podem processar dados ‚Äî <strong>sem treinamento com dados de usu√°rios</strong></li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>All patient/client data <strong>belongs to you</strong></li><li>BotNursery processes data as a <strong>data processor</strong></li><li>Data on encrypted servers (EU)</li><li>No data sharing with third parties</li><li>Data export or deletion at any time</li><li>LGPD and HIPAA compliant</li><li>AI providers (Anthropic) may process data ‚Äî <strong>no training on user data</strong></li></ul>
                </section>
                <!-- Section 6 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">6.</span> <span class="lang-pt">Propriedade Intelectual</span><span class="lang-en hidden">Intellectual Property</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Seus materiais de treinamento permanecem sua propriedade</li><li>A personalidade do bot √© co-criada e pertence a voc√™</li><li>BotNursery ret√©m direitos sobre a plataforma e infraestrutura</li><li>Padr√µes agregados e anonimizados podem ser usados para melhorar a plataforma</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Your training materials remain your property</li><li>Bot personality is co-created and belongs to you</li><li>BotNursery retains rights to platform and infrastructure</li><li>Aggregated, anonymized patterns may be used to improve the platform</li></ul>
                </section>
                <!-- Section 7 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">7.</span> <span class="lang-pt">Pre√ßos e Pagamento</span><span class="lang-en hidden">Pricing & Payment</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Plano base a partir de R$149/m√™s (US$29) + custo por paciente/cliente/aluno ativo</li><li>7 dias de teste gratuito; cancele quando quiser (basta solicitar ao seu agente)</li><li>Pre√ßos futuros comunicados com 30 dias de anteced√™ncia</li><li>Sem reembolsos para meses parciais</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Base plan from $29/month (R$149) + per active patient/client/student cost</li><li>7-day free trial; cancel anytime (just ask your agent)</li><li>Future pricing communicated 30 days in advance</li><li>No refunds for partial months</li></ul>
                </section>
                <!-- Section 7.1 - Fair Use -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">7.1</span> <span class="lang-pt">Pol√≠tica de Uso Justo</span><span class="lang-en hidden">Fair Use Policy</span></h3>
                    <div class="pl-4 lang-pt">
                        <p>O uso da plataforma est√° sujeito a limites de uso justo. O uso pelo profissional √© limitado a 5.000.000 de tokens por m√™s, e o uso por paciente/cliente/aluno √© limitado a 500.000 tokens por m√™s. Uso al√©m destes limites pode resultar em redu√ß√£o tempor√°ria da velocidade do servi√ßo ou cobran√ßa adicional mediante aviso pr√©vio. Estes limites s√£o revisados periodicamente e podem ser ajustados com 30 dias de anteced√™ncia.</p>
                    </div>
                    <div class="pl-4 lang-en hidden">
                        <p>Platform usage is subject to fair use limits. Professional usage is limited to 5,000,000 tokens per month, and per-patient/client/student usage is limited to 500,000 tokens per month. Usage beyond these limits may result in temporary service speed reduction or additional charges upon prior notice. These limits are reviewed periodically and may be adjusted with 30 days notice.</p>
                    </div>
                </section>
                <!-- Section 8 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">8.</span> <span class="lang-pt">Prazo e Rescis√£o</span><span class="lang-en hidden">Term & Termination</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Contrato m√™s a m√™s</li><li>Qualquer parte pode rescindir com 30 dias de aviso</li><li>Na rescis√£o: exporta√ß√£o completa de dados, bot desativado</li><li>Dados mantidos por 90 dias, depois exclu√≠dos</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Month-to-month agreement</li><li>Either party may terminate with 30 days notice</li><li>Upon termination: full data export, bot deactivated</li><li>Data retained 90 days, then deleted</li></ul>
                </section>
                <!-- Section 9 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">9.</span> <span class="lang-pt">Limita√ß√£o de Responsabilidade</span><span class="lang-en hidden">Limitation of Liability</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>BotNursery √© uma ferramenta, <strong>n√£o um consultor profissional</strong></li><li>Voc√™ √© respons√°vel por todas as decis√µes profissionais</li><li>BotNursery n√£o se responsabiliza por respostas usadas sem sua revis√£o, resultados de pacientes, ou conformidade regulat√≥ria</li><li>Responsabilidade m√°xima limitada √†s taxas pagas nos 12 meses anteriores</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>BotNursery is a tool, <strong>not a professional advisor</strong></li><li>You are responsible for all professional decisions</li><li>BotNursery not liable for responses used without your review, patient outcomes, or regulatory compliance</li><li>Maximum liability limited to fees paid in prior 12 months</li></ul>
                </section>
                <!-- Section 10 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">10.</span> <span class="lang-pt">Confidencialidade</span><span class="lang-en hidden">Confidentiality</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Ambas as partes concordam em manter informa√ß√µes confidenciais privadas</li><li>Dados de pacientes s√£o o mais alto n√≠vel de confidencialidade</li><li>Equipe BotNursery pode acessar configura√ß√£o do bot apenas para fins de suporte</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Both parties agree to keep confidential information private</li><li>Patient data is the highest level of confidentiality</li><li>BotNursery team may access bot configuration for support purposes only</li></ul>
                </section>
                <!-- Section 11 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">11.</span> <span class="lang-pt">Modifica√ß√µes</span><span class="lang-en hidden">Modifications</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>BotNursery pode atualizar estes termos com 30 dias de aviso</li><li>Uso continuado ap√≥s o aviso constitui aceita√ß√£o</li><li>Mudan√ßas materiais requerem nova assinatura</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>BotNursery may update terms with 30 days notice</li><li>Continued use after notice constitutes acceptance</li><li>Material changes require re-signing</li></ul>
                </section>
                <!-- Section 12 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">12.</span> <span class="lang-pt">Lei Aplic√°vel</span><span class="lang-en hidden">Governing Law</span></h3>
                    <ul class="list-disc pl-8 space-y-1 lang-pt"><li>Lei brasileira (LGPD) para profissionais brasileiros</li><li>Lei dos EUA (Calif√≥rnia) para profissionais nos EUA</li><li>Disputas resolvidas por arbitragem em sua jurisdi√ß√£o</li></ul>
                    <ul class="list-disc pl-8 space-y-1 lang-en hidden"><li>Brazilian law (LGPD) for Brazilian professionals</li><li>US law (California) for US-based professionals</li><li>Disputes resolved by arbitration in your jurisdiction</li></ul>
                </section>
                <!-- Section 13 -->
                <section>
                    <h3 class="text-lg font-bold text-gray-800 mb-2"><span class="text-blue-600">13.</span> <span class="lang-pt">Contato</span><span class="lang-en hidden">Contact</span></h3>
                    <ul class="list-disc pl-8 space-y-1"><li><strong>Email:</strong> <a href="mailto:hello@botnursery.ai" class="text-blue-600">hello@botnursery.ai</a></li><li><strong>Web:</strong> <a href="https://www.botnursery.ai" class="text-blue-600">www.botnursery.ai</a></li><li><strong><span class="lang-pt">Suporte:</span><span class="lang-en hidden">Support:</span></strong> <span class="lang-pt">via BotMother no Telegram</span><span class="lang-en hidden">via BotMother on Telegram</span></li></ul>
                </section>
            </div>
            <div class="border-t p-4 flex-shrink-0">
                <button onclick="closeAgreementModal()" class="w-full gradient-bg text-white font-semibold py-3 rounded-lg hover:opacity-90 transition-all">
                    <span class="lang-pt">Fechar</span>
                    <span class="lang-en hidden">Close</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Pre-fill Banner -->
    <div id="prefillBanner" class="hidden fixed top-20 left-0 right-0 z-30">
        <div class="max-w-4xl mx-auto px-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                <span class="text-green-800 font-medium">
                    <span class="lang-pt">‚ú® J√° preenchemos alguns dados pra voc√™!</span>
                    <span class="lang-en hidden">‚ú® We've pre-filled some info for you!</span>
                </span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="pt-28 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            
            <!-- Step 1: Welcome & Plans -->
            <div id="step1" class="step-content">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Que bom que voc√™ est√° aqui!</span>
                        <span class="lang-en hidden">We're glad you're here!</span>
                    </h1>
                    <p class="text-xl text-gray-600">
                        <span class="lang-pt">Vamos criar seu assistente de IA.</span>
                        <span class="lang-en hidden">Let's create your AI assistant.</span>
                    </p>
                    <p class="text-sm text-gray-500 mt-2 italic">
                        <span class="lang-pt">BotFather cria bots. BotMother os cria.</span>
                        <span class="lang-en hidden">BotFather creates bots. BotMother raises them.</span>
                    </p>
                </div>

                <!-- Professional can charge patients callout -->
                <div class="callout-box mb-6 max-w-3xl mx-auto">
                    <div class="flex items-start">
                        <div class="text-3xl mr-3">üí∞</div>
                        <div>
                            <h3 class="font-bold text-gray-800 mb-1">
                                <span class="lang-pt">Voc√™ sabia?</span>
                                <span class="lang-en hidden">Did you know?</span>
                            </h3>
                            <p class="text-sm text-gray-700">
                                <span class="lang-pt">Voc√™ pode cobrar seus pacientes, clientes ou alunos pelo acesso ao bot! Defina qualquer valor que desejar e a plataforma transfere diretamente para voc√™ (menos custos de transa√ß√£o). Essa funcionalidade √© configurada depois, diretamente com o seu assistente.</span>
                                <span class="lang-en hidden">You can charge your patients, clients or students for bot access! Set any amount you want and the platform transfers directly to you (minus transaction costs). This feature is set up later, directly with your assistant.</span>
                            </p>
                        </div>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Starter Plan -->
                    <div class="plan-card bg-white rounded-xl p-6 card-shadow relative" data-plan="starter">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Starter</h3>
                        <div class="text-3xl font-bold text-purple-600 mb-1">
                            <span class="lang-pt">R$149<span class="text-lg text-gray-500">/m√™s</span></span>
                            <span class="lang-en hidden">$29<span class="text-lg text-gray-500">/mo</span></span>
                        </div>
                        <div class="text-gray-600 mb-4">
                            <span class="lang-pt">+ R$25/paciente, cliente ou aluno ativo/m√™s</span>
                            <span class="lang-en hidden">+ $5/active patient, client or student/mo</span>
                            <span class="info-icon" onclick="openPricingModal()">‚ÑπÔ∏è</span>
                        </div>
                        <div class="border-t pt-4 mb-4">
                            <div class="text-sm text-gray-600 space-y-2">
                                <div class="flex justify-between">
                                    <span>5 <span class="lang-pt">pacientes, clientes ou alunos</span><span class="lang-en hidden">patients, clients or students</span>:</span>
                                    <span class="font-semibold lang-pt">R$274/m√™s</span>
                                    <span class="font-semibold lang-en hidden">$54/mo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>20 <span class="lang-pt">pacientes, clientes ou alunos</span><span class="lang-en hidden">patients, clients or students</span>:</span>
                                    <span class="font-semibold lang-pt">R$649/m√™s</span>
                                    <span class="font-semibold lang-en hidden">$129/mo</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
                            <div class="text-green-800 text-sm font-medium">
                                ‚úì <span class="lang-pt">7 dias gr√°tis</span><span class="lang-en hidden">7-day free trial</span>
                            </div>
                            <div class="text-green-700 text-xs">
                                <span class="lang-pt">Cancele quando quiser</span>
                                <span class="lang-en hidden">Cancel anytime</span>
                            </div>
                        </div>
                        <button class="w-full bg-gray-100 text-gray-800 font-semibold py-3 rounded-lg hover:bg-gray-200 transition-all plan-select" data-plan="starter">
                            <span class="lang-pt">Selecionar</span>
                            <span class="lang-en hidden">Select</span>
                        </button>
                    </div>

                    <!-- Founding Practitioner Plan -->
                    <div class="plan-card bg-white rounded-xl p-6 card-shadow relative" data-plan="founding">
                        <div class="badge">
                            <span class="lang-pt">üéâ FUNDADOR</span>
                            <span class="lang-en hidden">üéâ FOUNDING</span>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">
                            <span class="lang-pt">Fundador</span>
                            <span class="lang-en hidden">Founding Practitioner</span>
                        </h3>
                        <div class="text-3xl font-bold text-purple-600 mb-1">
                            <span class="lang-pt"><span class="line-through text-gray-400 text-xl">R$149</span> R$75<span class="text-lg text-gray-500">/m√™s</span></span>
                            <span class="lang-en hidden"><span class="line-through text-gray-400 text-xl">$29</span> $15<span class="text-lg text-gray-500">/mo</span></span>
                        </div>
                        <div class="text-xs text-orange-600 font-semibold mb-3">
                            <span class="lang-pt">50% OFF por 6 meses!</span>
                            <span class="lang-en hidden">50% OFF for 6 months!</span>
                        </div>
                        <div class="text-gray-600 mb-4">
                            <span class="lang-pt">+ R$12,50/paciente, cliente ou aluno ativo/m√™s</span>
                            <span class="lang-en hidden">+ $2.50/active patient, client or student/mo</span>
                            <span class="info-icon" onclick="openPricingModal()">‚ÑπÔ∏è</span>
                        </div>
                        <div class="border-t pt-4 mb-4">
                            <div class="text-sm text-gray-600 space-y-2">
                                <div class="flex justify-between">
                                    <span>5 <span class="lang-pt">pacientes, clientes ou alunos</span><span class="lang-en hidden">patients, clients or students</span>:</span>
                                    <span class="font-semibold lang-pt">R$137,50/m√™s</span>
                                    <span class="font-semibold lang-en hidden">$27.50/mo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>20 <span class="lang-pt">pacientes, clientes ou alunos</span><span class="lang-en hidden">patients, clients or students</span>:</span>
                                    <span class="font-semibold lang-pt">R$325/m√™s</span>
                                    <span class="font-semibold lang-en hidden">$65/mo</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Fundador explanation -->
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4 text-xs text-gray-700">
                            <p>
                                <span class="lang-pt">üå± <strong>Fundador</strong> = adotante inicial da nossa plataforma. Como agradecimento por acreditar no BotNursery desde o in√≠cio, voc√™ recebe 50% de desconto nos primeiros 6 meses, acesso direto ao time fundador, e prioridade em novas funcionalidades.</span>
                                <span class="lang-en hidden">üå± <strong>Founder</strong> = early adopter of our platform. As thanks for believing in BotNursery from the start, you get 50% off for 6 months, direct access to the founding team, and priority on new features.</span>
                            </p>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
                            <div class="text-green-800 text-sm font-medium">
                                ‚úì <span class="lang-pt">7 dias gr√°tis</span><span class="lang-en hidden">7-day free trial</span>
                            </div>
                            <div class="text-green-700 text-xs">
                                <span class="lang-pt">Cancele quando quiser</span>
                                <span class="lang-en hidden">Cancel anytime</span>
                            </div>
                        </div>
                        <button class="w-full gradient-bg text-white font-semibold py-3 rounded-lg hover:opacity-90 transition-all plan-select" data-plan="founding">
                            <span class="lang-pt">Selecionar (Melhor Valor!)</span>
                            <span class="lang-en hidden">Select (Best Value!)</span>
                        </button>
                    </div>
                </div>

                <div class="text-center">
                    <button id="step1Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <span class="lang-pt">Pr√≥ximo ‚Üí</span>
                        <span class="lang-en hidden">Next ‚Üí</span>
                    </button>
                </div>
            </div>

            <!-- Step 2: Your Information -->
            <div id="step2" class="step-content hidden">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Suas Informa√ß√µes</span>
                        <span class="lang-en hidden">Your Information</span>
                    </h1>
                    <p class="text-xl text-gray-600">
                        <span class="lang-pt">Conte-nos um pouco sobre voc√™</span>
                        <span class="lang-en hidden">Tell us a bit about yourself</span>
                    </p>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-2xl mx-auto">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Nome completo</span>
                                <span class="lang-en hidden">Full name</span>
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="fullName" class="w-full stripe-input" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Profiss√£o/Especialidade</span>
                                <span class="lang-en hidden">Profession/Specialty</span>
                                <span class="text-red-500">*</span>
                            </label>
                            <select id="profession" class="w-full stripe-input" required>
                                <option value="">
                                    <span class="lang-pt">Selecione...</span>
                                    <span class="lang-en hidden">Select...</span>
                                </option>
                                <option value="medico">M√©dico(a)</option>
                                <option value="psicologo">Psic√≥logo(a)</option>
                                <option value="nutricionista">Nutricionista</option>
                                <option value="coach">Coach</option>
                                <option value="advogado">Advogado(a)</option>
                                <option value="fisioterapeuta">Fisioterapeuta</option>
                                <option value="dentista">Dentista</option>
                                <option value="consultor">Consultor(a)</option>
                                <option value="personal">Personal Trainer</option>
                                <option value="outro">
                                    <span class="lang-pt">Outro</span>
                                    <span class="lang-en hidden">Other</span>
                                </option>
                            </select>
                        </div>

                        <div id="otherProfessionDiv" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Especifique sua profiss√£o</span>
                                <span class="lang-en hidden">Specify your profession</span>
                            </label>
                            <input type="text" id="otherProfession" class="w-full stripe-input">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">N√∫mero de registro profissional</span>
                                <span class="lang-en hidden">Professional registration number</span>
                                <span class="text-gray-500 text-xs">
                                    (<span class="lang-pt">CRM, CRP, OAB, etc. - opcional</span><span class="lang-en hidden">CRM, CRP, OAB, etc. - optional</span>)
                                </span>
                            </label>
                            <input type="text" id="registration" class="w-full stripe-input" placeholder="12345-UF">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Email</span>
                                <span class="lang-en hidden">Email</span>
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="email" id="email" class="w-full stripe-input" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Telefone</span>
                                <span class="lang-en hidden">Phone</span>
                                <span class="text-gray-500 text-xs">
                                    (<span class="lang-pt">opcional</span><span class="lang-en hidden">optional</span>)
                                </span>
                            </label>
                            <input type="tel" id="phone" class="w-full stripe-input" placeholder="+55 11 99999-9999">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Pa√≠s</span>
                                <span class="lang-en hidden">Country</span>
                                <span class="text-red-500">*</span>
                            </label>
                            <select id="country" class="w-full stripe-input" required>
                                <option value="">
                                    <span class="lang-pt">Selecione...</span>
                                    <span class="lang-en hidden">Select...</span>
                                </option>
                                <option value="BR">
                                    <span class="lang-pt">Brasil</span>
                                    <span class="lang-en hidden">Brazil</span>
                                </option>
                                <option value="US">
                                    <span class="lang-pt">Estados Unidos</span>
                                    <span class="lang-en hidden">United States</span>
                                </option>
                                <option value="OTHER">
                                    <span class="lang-pt">Outro</span>
                                    <span class="lang-en hidden">Other</span>
                                </option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-8 max-w-2xl mx-auto">
                    <button class="step-back text-gray-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all">
                        <span class="lang-pt">‚Üê Voltar</span>
                        <span class="lang-en hidden">‚Üê Back</span>
                    </button>
                    <button id="step2Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all">
                        <span class="lang-pt">Pr√≥ximo ‚Üí</span>
                        <span class="lang-en hidden">Next ‚Üí</span>
                    </button>
                </div>
            </div>

            <!-- Step 3: Payment ‚Äî Stripe Checkout redirect -->
            <div id="step3" class="step-content hidden">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Pagamento Seguro</span>
                        <span class="lang-en hidden">Secure Payment</span>
                    </h1>
                    <p class="text-xl text-green-600 font-semibold">
                        <span class="lang-pt">‚ú® Seu trial de 7 dias √© gratuito!</span>
                        <span class="lang-en hidden">‚ú® Your 7-day trial is free!</span>
                    </p>
                    <p class="text-sm text-gray-600 mt-2">
                        <span class="lang-pt">Cobran√ßa inicia apenas ap√≥s o per√≠odo de teste</span>
                        <span class="lang-en hidden">Billing starts only after trial period</span>
                    </p>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-2xl mx-auto">
                    <!-- Plan summary -->
                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="font-semibold text-gray-800" id="checkoutPlanName">
                                    <span class="lang-pt">Plano Selecionado</span>
                                    <span class="lang-en hidden">Selected Plan</span>
                                </div>
                                <div class="text-sm text-gray-600 mt-1" id="checkoutPlanPrice"></div>
                            </div>
                            <span class="text-3xl">ü§ñ</span>
                        </div>
                    </div>

                    <div class="space-y-4 mb-6">
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úì</span>
                            <span class="lang-pt">7 dias gr√°tis ‚Äî cancele quando quiser</span>
                            <span class="lang-en hidden">7 days free ‚Äî cancel anytime</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úì</span>
                            <span class="lang-pt">Pagamento seguro via <strong>Stripe</strong></span>
                            <span class="lang-en hidden">Secure payment via <strong>Stripe</strong></span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úì</span>
                            <span class="lang-pt">N√≥s nunca vemos seus dados de cart√£o</span>
                            <span class="lang-en hidden">We never see your card details</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úì</span>
                            <span class="lang-pt">C√≥digo promocional? Use na pr√≥xima tela</span>
                            <span class="lang-en hidden">Promo code? Use it on the next screen</span>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-start space-x-2 text-blue-800 text-sm">
                            <span class="mt-0.5">üîí</span>
                            <div>
                                <div class="font-semibold">
                                    <span class="lang-pt">Como funciona</span>
                                    <span class="lang-en hidden">How it works</span>
                                </div>
                                <div class="text-xs mt-1">
                                    <span class="lang-pt">Voc√™ ser√° redirecionado para o <strong>Stripe</strong> (nosso processador de pagamentos) para inserir seus dados de cart√£o de forma segura. Ap√≥s confirmar, voltar√° automaticamente para completar seu cadastro.</span>
                                    <span class="lang-en hidden">You'll be redirected to <strong>Stripe</strong> (our payment processor) to securely enter your card details. After confirming, you'll return automatically to complete your setup.</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-8 max-w-2xl mx-auto">
                    <button class="step-back text-gray-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all">
                        <span class="lang-pt">‚Üê Voltar</span>
                        <span class="lang-en hidden">‚Üê Back</span>
                    </button>
                    <button id="step3Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all">
                        <span class="lang-pt">üí≥ Ir para Pagamento ‚Üí</span>
                        <span class="lang-en hidden">üí≥ Proceed to Payment ‚Üí</span>
                    </button>
                </div>
                <!-- Loading state for checkout redirect -->
                <div id="checkoutLoading" class="hidden text-center mt-6">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-purple-500 border-t-transparent"></div>
                    <p class="mt-2 text-gray-600">
                        <span class="lang-pt">Redirecionando para o Stripe...</span>
                        <span class="lang-en hidden">Redirecting to Stripe...</span>
                    </p>
                </div>
            </div>

            <!-- Step 4: Set Up Telegram -->
            <div id="step4" class="step-content hidden">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Configurar Telegram</span>
                        <span class="lang-en hidden">Set Up Telegram</span>
                    </h1>
                    <p class="text-xl text-gray-600">
                        <span class="lang-pt">√â por onde seu agente vai se comunicar! üí¨</span>
                        <span class="lang-en hidden">This is where your agent will live! üí¨</span>
                    </p>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-2xl mx-auto">
                    <!-- Sub-step 4a: Do you have Telegram? -->
                    <div id="step4a">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">
                            <span class="lang-pt">Voc√™ tem Telegram?</span>
                            <span class="lang-en hidden">Do you have Telegram?</span>
                        </h3>
                        <div class="flex gap-4 mb-6">
                            <button id="hasTelegram" class="flex-1 bg-green-500 hover:bg-green-600 text-white font-semibold py-3 rounded-lg transition-all">
                                <span class="lang-pt">‚úì Sim</span>
                                <span class="lang-en hidden">‚úì Yes</span>
                            </button>
                            <button id="noTelegram" class="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg transition-all">
                                <span class="lang-pt">‚úó N√£o</span>
                                <span class="lang-en hidden">‚úó No</span>
                            </button>
                        </div>
                    </div>

                    <!-- Download links (shown when No is clicked) -->
                    <div id="telegramDownload" class="hidden mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-4">
                            <span class="lang-pt">Baixe o Telegram:</span>
                            <span class="lang-en hidden">Download Telegram:</span>
                        </h4>
                        <div class="grid grid-cols-3 gap-4">
                            <a href="https://apps.apple.com/app/telegram-messenger/id686449807" target="_blank" class="bg-blue-500 hover:bg-blue-600 text-white text-center py-3 rounded-lg transition-all flex flex-col items-center">
                                <span class="text-2xl mb-1">üì±</span>
                                <span class="text-sm">iOS</span>
                            </a>
                            <a href="https://play.google.com/store/apps/details?id=org.telegram.messenger" target="_blank" class="bg-green-500 hover:bg-green-600 text-white text-center py-3 rounded-lg transition-all flex flex-col items-center">
                                <span class="text-2xl mb-1">ü§ñ</span>
                                <span class="text-sm">Android</span>
                            </a>
                            <a href="https://desktop.telegram.org/" target="_blank" class="bg-purple-500 hover:bg-purple-600 text-white text-center py-3 rounded-lg transition-all flex flex-col items-center">
                                <span class="text-2xl mb-1">üíª</span>
                                <span class="text-sm">Desktop</span>
                            </a>
                        </div>
                        <button id="downloadedTelegram" class="w-full mt-4 bg-gray-800 hover:bg-gray-900 text-white font-semibold py-3 rounded-lg transition-all">
                            <span class="lang-pt">J√° instalei ‚úì</span>
                            <span class="lang-en hidden">I installed it ‚úì</span>
                        </button>
                    </div>

                    <!-- Sub-step 4b: Get Telegram ID -->
                    <div id="step4b" class="hidden">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">
                            <span class="lang-pt">Descubra seu Telegram ID</span>
                            <span class="lang-en hidden">Find your Telegram ID</span>
                        </h3>
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-gray-700 mb-2">
                                <span class="lang-pt"><strong>Instru√ß√µes:</strong></span>
                                <span class="lang-en hidden"><strong>Instructions:</strong></span>
                            </p>
                            <ol class="list-decimal list-inside text-sm text-gray-600 space-y-2">
                                <li>
                                    <span class="lang-pt">Abra o Telegram</span>
                                    <span class="lang-en hidden">Open Telegram</span>
                                </li>
                                <li>
                                    <span class="lang-pt">Busque por <strong>@userinfobot</strong></span>
                                    <span class="lang-en hidden">Search for <strong>@userinfobot</strong></span>
                                </li>
                                <li>
                                    <span class="lang-pt">Envie qualquer mensagem</span>
                                    <span class="lang-en hidden">Send any message</span>
                                </li>
                                <li>
                                    <span class="lang-pt">Ele vai responder com seu ID</span>
                                    <span class="lang-en hidden">It will reply with your ID</span>
                                </li>
                            </ol>
                        </div>
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4 text-center">
                            <div class="text-4xl mb-2">üì∏</div>
                            <p class="text-xs text-gray-500">
                                <span class="lang-pt">[Espa√ßo para screenshot ilustrativa]</span>
                                <span class="lang-en hidden">[Illustrative screenshot placeholder]</span>
                            </p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Cole seu Telegram ID aqui</span>
                                <span class="lang-en hidden">Paste your Telegram ID here</span>
                                <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="telegramId" class="w-full stripe-input" placeholder="123456789" pattern="[0-9]+">
                            <p class="text-xs text-gray-500 mt-1">
                                <span class="lang-pt">Deve ser apenas n√∫meros</span>
                                <span class="lang-en hidden">Must be numbers only</span>
                            </p>
                        </div>

                        <!-- Alternative: paste userinfobot response -->
                        <div class="mt-4 border-t pt-4">
                            <p class="text-sm text-gray-600 mb-2">
                                <span class="lang-pt">Ou cole a resposta do @userinfobot aqui:</span>
                                <span class="lang-en hidden">Or paste the @userinfobot response here:</span>
                            </p>
                            <textarea id="userinfoResponse" class="w-full stripe-input text-sm font-mono" rows="4" placeholder="Id: 123456789&#10;First: Jo√£o&#10;Last: Silva&#10;Username: @joaosilva"></textarea>
                            <div id="parsedTelegramId" class="hidden parsed-field mt-2">
                                <span class="checkmark">‚úÖ</span>
                                <span>Telegram ID: </span>
                                <span class="value" id="parsedTelegramIdValue"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-8 max-w-2xl mx-auto">
                    <button class="step-back text-gray-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all">
                        <span class="lang-pt">‚Üê Voltar</span>
                        <span class="lang-en hidden">‚Üê Back</span>
                    </button>
                    <button id="step4Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all hidden">
                        <span class="lang-pt">Pr√≥ximo ‚Üí</span>
                        <span class="lang-en hidden">Next ‚Üí</span>
                    </button>
                </div>
            </div>

            <!-- Step 5: Create Your Bot -->
            <div id="step5" class="step-content hidden">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Hora de criar seu bot! ü§ñ</span>
                        <span class="lang-en hidden">Time to create your bot! ü§ñ</span>
                    </h1>
                    <p class="text-xl text-gray-600">
                        <span class="lang-pt">Siga os passos abaixo no Telegram</span>
                        <span class="lang-en hidden">Follow the steps below in Telegram</span>
                    </p>
                </div>

                <!-- Bot explanation callout -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6 max-w-3xl mx-auto">
                    <div class="flex items-start">
                        <div class="text-2xl mr-3">‚ÑπÔ∏è</div>
                        <div>
                            <p class="text-sm text-gray-700">
                                <span class="lang-pt">O bot que voc√™ vai criar no Telegram √© apenas a interface ‚Äî como uma porta de entrada. O verdadeiro c√©rebro do seu agente vive na BotNursery, onde ele vai crescer, aprender e evoluir com voc√™. Pense no bot como o rosto, e a BotNursery como a mente.</span>
                                <span class="lang-en hidden">The bot you'll create on Telegram is just the interface ‚Äî like a front door. Your agent's real brain lives in BotNursery, where it will grow, learn, and evolve with you. Think of the bot as the face, and BotNursery as the mind.</span>
                            </p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-3xl mx-auto">
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <span class="lang-pt">Passo a passo:</span>
                                <span class="lang-en hidden">Step by step:</span>
                            </h3>
                            <div class="space-y-4">
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">1</div>
                                        <p class="text-sm text-gray-700">
                                            <span class="lang-pt">Abra o Telegram e busque <strong>@BotFather</strong></span>
                                            <span class="lang-en hidden">Open Telegram and search for <strong>@BotFather</strong></span>
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">2</div>
                                        <p class="text-sm text-gray-700">
                                            <span class="lang-pt">Envie <strong>/newbot</strong></span>
                                            <span class="lang-en hidden">Send <strong>/newbot</strong></span>
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">3</div>
                                        <p class="text-sm text-gray-700">
                                            <span class="lang-pt">Escolha um nome para seu bot<br><span class="text-xs text-gray-500">(ex: "Assistente Dr. Silva")</span></span>
                                            <span class="lang-en hidden">Choose a name for your bot<br><span class="text-xs text-gray-500">(e.g., "Dr. Silva Assistant")</span></span>
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">4</div>
                                        <p class="text-sm text-gray-700">
                                            <span class="lang-pt">Escolha um username<br><span class="text-xs text-gray-500">(ex: @DrSilvaAssistenteBot - deve terminar em "Bot")</span></span>
                                            <span class="lang-en hidden">Choose a username<br><span class="text-xs text-gray-500">(e.g., @DrSilvaAssistantBot - must end in "Bot")</span></span>
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">5</div>
                                        <p class="text-sm text-gray-700">
                                            <span class="lang-pt">O BotFather vai enviar um <strong>token</strong>. Copie a mensagem toda!</span>
                                            <span class="lang-en hidden">BotFather will send a <strong>token</strong>. Copy the entire message!</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-start">
                                        <div class="bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold mr-3 flex-shrink-0">6</div>
                                        <p class="text-sm text-red-800">
                                            <strong>IMPORTANTE:</strong>
                                            <span class="lang-pt">Envie <strong>/setprivacy</strong> para @BotFather, selecione seu bot, e escolha <strong>Disable</strong></span>
                                            <span class="lang-en hidden">Send <strong>/setprivacy</strong> to @BotFather, select your bot, and choose <strong>Disable</strong></span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">
                                <span class="lang-pt">Exemplo de conversa:</span>
                                <span class="lang-en hidden">Example conversation:</span>
                            </h3>
                            <div class="bg-gray-800 text-gray-200 rounded-lg p-4 text-xs font-mono h-96 overflow-y-auto">
                                <div class="mb-2"><span class="text-blue-400">You:</span> /newbot</div>
                                <div class="mb-3"><span class="text-green-400">BotFather:</span> Alright, a new bot. How are we going to call it? Please choose a name for your bot.</div>
                                <div class="mb-2"><span class="text-blue-400">You:</span> Assistente Dr. Silva</div>
                                <div class="mb-3"><span class="text-green-400">BotFather:</span> Good. Now let's choose a username for your bot. It must end in `bot`. Like this, for example: TetrisBot or tetris_bot.</div>
                                <div class="mb-2"><span class="text-blue-400">You:</span> DrSilvaAssistenteBot</div>
                                <div class="mb-3"><span class="text-green-400">BotFather:</span> Done! Congratulations on your new bot. You will find it at t.me/DrSilvaAssistenteBot. You can now add a description, about section and profile picture for your bot, see /help for a list of commands.<br><br>Use this token to access the HTTP API:<br><strong class="text-yellow-300">123456789:ABCdefGHIjklMNOpqrsTUVwxyz</strong><br><br>Keep your token secure and store it safely, it can be used by anyone to control your bot.</div>
                            </div>
                        </div>
                    </div>

                    <div class="border-t pt-6 space-y-4">
                        <!-- BotFather message paste textarea -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <span class="lang-pt">Cole aqui a mensagem completa que o BotFather enviou:</span>
                                <span class="lang-en hidden">Paste the complete message from BotFather here:</span>
                            </label>
                            <textarea id="botfatherMessage" class="w-full stripe-input font-mono text-sm" rows="8" placeholder="Done! Congratulations on your new bot. You will find it at t.me/DrSilvaAssistenteBot...

Use this token to access the HTTP API:
123456789:ABCdefGHIjklMNOpqrsTUVwxyz

Keep your token secure..."></textarea>
                        </div>

                        <!-- Parsed results -->
                        <div id="parsedResults" class="hidden space-y-2">
                            <div id="parsedToken" class="parsed-field hidden">
                                <span class="checkmark">‚úÖ</span>
                                <span class="lang-pt">Token encontrado: </span>
                                <span class="lang-en hidden">Token found: </span>
                                <span class="value" id="parsedTokenValue"></span>
                            </div>
                            <div id="parsedUsername" class="parsed-field hidden">
                                <span class="checkmark">‚úÖ</span>
                                <span>Username: </span>
                                <span class="value" id="parsedUsernameValue"></span>
                            </div>
                            <div id="parsedName" class="parsed-field hidden">
                                <span class="checkmark">‚úÖ</span>
                                <span class="lang-pt">Nome: </span>
                                <span class="lang-en hidden">Name: </span>
                                <span class="value" id="parsedNameValue"></span>
                            </div>
                        </div>

                        <!-- Manual fallback fields -->
                        <div id="manualFields" class="hidden space-y-4">
                            <div class="text-center mb-3">
                                <button id="showManualFields" class="text-sm text-purple-600 hover:underline">
                                    <span class="lang-pt">N√£o conseguiu? Preencha manualmente</span>
                                    <span class="lang-en hidden">Didn't work? Fill in manually</span>
                                </button>
                            </div>
                            <div id="manualInputs" class="hidden space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <span class="lang-pt">Cole o token do seu bot aqui</span>
                                        <span class="lang-en hidden">Paste your bot token here</span>
                                        <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="botTokenManual" class="w-full stripe-input font-mono text-sm" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <span class="lang-pt">Username do seu bot</span>
                                        <span class="lang-en hidden">Your bot's username</span>
                                        <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="botUsernameManual" class="w-full stripe-input" placeholder="@DrSilvaAssistenteBot">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <span class="lang-pt">Nome do seu bot</span>
                                        <span class="lang-en hidden">Your bot's name</span>
                                        <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="botNameManual" class="w-full stripe-input" placeholder="Assistente Dr. Silva">
                                </div>
                            </div>
                        </div>

                        <!-- Hidden fields to store parsed values -->
                        <input type="hidden" id="botToken">
                        <input type="hidden" id="botUsername">
                        <input type="hidden" id="botName">
                    </div>
                </div>

                <div class="flex justify-between mt-8 max-w-3xl mx-auto">
                    <button class="step-back text-gray-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all">
                        <span class="lang-pt">‚Üê Voltar</span>
                        <span class="lang-en hidden">‚Üê Back</span>
                    </button>
                    <button id="step5Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all">
                        <span class="lang-pt">Pr√≥ximo ‚Üí</span>
                        <span class="lang-en hidden">Next ‚Üí</span>
                    </button>
                </div>
            </div>

            <!-- Step 6: Professional Agreement -->
            <div id="step6" class="step-content hidden">
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Termos de Servi√ßo</span>
                        <span class="lang-en hidden">Terms of Service</span>
                    </h1>
                    <p class="text-xl text-gray-600">
                        <span class="lang-pt">Quase l√°! S√≥ precisamos do seu acordo.</span>
                        <span class="lang-en hidden">Almost there! We just need your agreement.</span>
                    </p>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-3xl mx-auto">
                    <div class="prose max-w-none mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <span class="lang-pt">Resumo dos Termos Principais:</span>
                            <span class="lang-en hidden">Summary of Key Terms:</span>
                        </h3>
                        <div class="bg-gray-50 rounded-lg p-6 space-y-4 text-sm text-gray-700">
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl">‚úì</span>
                                <div>
                                    <strong class="lang-pt">Seus dados s√£o seus</strong>
                                    <strong class="lang-en hidden">Your data is yours</strong>
                                    <p class="text-gray-600 mt-1">
                                        <span class="lang-pt">Voc√™ mant√©m total propriedade de todas as suas informa√ß√µes e conversas com pacientes, clientes ou alunos.</span>
                                        <span class="lang-en hidden">You retain full ownership of all your information and patient, client or student conversations.</span>
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl">‚úì</span>
                                <div>
                                    <strong class="lang-pt">Prote√ß√£o de dados (LGPD/HIPAA)</strong>
                                    <strong class="lang-en hidden">Data protection (LGPD/HIPAA compliant)</strong>
                                    <p class="text-gray-600 mt-1">
                                        <span class="lang-pt">Seus dados s√£o criptografados e protegidos de acordo com as leis de privacidade internacionais.</span>
                                        <span class="lang-en hidden">Your data is encrypted and protected in accordance with international privacy laws.</span>
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <span class="text-yellow-600 mr-3 text-xl">‚ö†</span>
                                <div>
                                    <strong class="lang-pt">Responsabilidade profissional</strong>
                                    <strong class="lang-en hidden">Professional responsibility</strong>
                                    <p class="text-gray-600 mt-1">
                                        <span class="lang-pt">Voc√™ √© respons√°vel pelas decis√µes profissionais. Seu agente √© uma ferramenta de apoio, n√£o substitui seu julgamento cl√≠nico.</span>
                                        <span class="lang-en hidden">You are responsible for professional decisions. Your agent is a support tool and does not replace your clinical judgment.</span>
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <span class="text-blue-600 mr-3 text-xl">‚úì</span>
                                <div>
                                    <strong class="lang-pt">Trial de 7 dias gratuito</strong>
                                    <strong class="lang-en hidden">7-day free trial</strong>
                                    <p class="text-gray-600 mt-1">
                                        <span class="lang-pt">Cancele quando quiser. Sem perguntas. Sem taxas de cancelamento.</span>
                                        <span class="lang-en hidden">Cancel anytime. No questions asked. No cancellation fees.</span>
                                    </p>
                                    <p class="text-gray-500 text-sm mt-2">
                                        <span class="lang-pt">üí¨ <strong>Como cancelo?</strong> √â s√≥ pedir ao seu assistente! Ele vai continuar te atendendo at√© o fim do per√≠odo. Voc√™ tamb√©m pode cancelar a qualquer momento no futuro ‚Äî √© s√≥ falar com o seu bot.</span>
                                        <span class="lang-en hidden">üí¨ <strong>How do I cancel?</strong> Just ask your assistant! It will continue serving you until the end of the period. You can also cancel at any time in the future ‚Äî just talk to your bot.</span>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6 text-center">
                            <a href="#" onclick="openAgreementModal(); return false;" class="text-purple-600 hover:underline text-sm">
                                <span class="lang-pt">üìÑ Ler os Termos de Servi√ßo completos</span>
                                <span class="lang-en hidden">üìÑ Read the full Terms of Service</span>
                            </a>
                        </div>
                    </div>

                    <div class="border-t pt-6">
                        <label class="flex items-start cursor-pointer">
                            <input type="checkbox" id="agreementCheck" class="mt-1 mr-3 w-5 h-5 text-purple-600 rounded">
                            <span class="text-sm text-gray-700">
                                <span class="lang-pt">Li e concordo com os Termos de Servi√ßo</span>
                                <span class="lang-en hidden">I have read and agree to the Terms of Service</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="flex justify-between mt-8 max-w-3xl mx-auto">
                    <button class="step-back text-gray-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all">
                        <span class="lang-pt">‚Üê Voltar</span>
                        <span class="lang-en hidden">‚Üê Back</span>
                    </button>
                    <button id="step6Next" class="gradient-bg text-white px-12 py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <span class="lang-pt">Criar Meu Agente! üöÄ</span>
                        <span class="lang-en hidden">Create My Agent! üöÄ</span>
                    </button>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden text-center mt-8">
                    <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"></div>
                    <p class="text-gray-600 mt-4">
                        <span class="lang-pt">Criando seu agente...</span>
                        <span class="lang-en hidden">Creating your agent...</span>
                    </p>
                </div>

                <!-- Error State -->
                <div id="errorState" class="hidden bg-red-50 border border-red-200 rounded-lg p-6 mt-8 max-w-3xl mx-auto">
                    <h3 class="text-red-800 font-semibold mb-2">

                        <span class="lang-pt">Ops! Algo deu errado.</span>
                        <span class="lang-en hidden">Oops! Something went wrong.</span>
                    </h3>
                    <p class="text-red-700 text-sm mb-4" id="errorMessage"></p>
                    <button id="retryButton" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-semibold transition-all">
                        <span class="lang-pt">Tentar Novamente</span>
                        <span class="lang-en hidden">Try Again</span>
                    </button>
                </div>
            </div>

            <!-- Step 7: Success -->
            <div id="step7" class="step-content hidden">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">üéâ</div>
                    <h1 class="text-5xl font-bold text-gray-800 mb-3">
                        <span class="lang-pt">Parab√©ns!</span>
                        <span class="lang-en hidden">Congratulations!</span>
                    </h1>
                    <p class="text-2xl text-purple-600 font-semibold">
                        <span class="lang-pt">Seu agente est√° sendo criado! ü§±</span>
                        <span class="lang-en hidden">Your agent is being created! ü§±</span>
                    </p>
                </div>

                <div class="bg-white rounded-xl p-8 card-shadow max-w-2xl mx-auto">
                    <div class="mb-6">
                        <p class="text-lg text-gray-700 mb-4">
                            <span class="lang-pt">Em poucos minutos, a <strong>BotMother</strong> vai criar um grupo no Telegram com voc√™ e seu novo agente.</span>
                            <span class="lang-en hidden">In a few minutes, <strong>BotMother</strong> will create a Telegram group with you and your new agent.</span>
                        </p>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-6 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <span class="lang-pt">O que esperar:</span>
                            <span class="lang-en hidden">What to expect:</span>
                        </h3>
                        <div class="space-y-3">
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl flex-shrink-0">‚úÖ</span>
                                <p class="text-gray-700">
                                    <span class="lang-pt">BotMother vai te enviar uma mensagem no Telegram</span>
                                    <span class="lang-en hidden">BotMother will send you a message on Telegram</span>
                                </p>
                            </div>
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl flex-shrink-0">‚úÖ</span>
                                <p class="text-gray-700">
                                    <span class="lang-pt">Ela vai criar um grupo com voc√™ e seu bot</span>
                                    <span class="lang-en hidden">She will create a group with you and your bot</span>
                                </p>
                            </div>
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl flex-shrink-0">‚úÖ</span>
                                <p class="text-gray-700">
                                    <span class="lang-pt">Juntos, voc√™s v√£o dar personalidade ao seu agente</span>
                                    <span class="lang-en hidden">Together, you will give your agent its personality</span>
                                </p>
                            </div>
                            <div class="flex items-start">
                                <span class="text-green-600 mr-3 text-xl flex-shrink-0">‚úÖ</span>
                                <p class="text-gray-700">
                                    <span class="lang-pt">Em 7 dias, seu bot estar√° pronto para atender seus clientes!</span>
                                    <span class="lang-en hidden">In 7 days, your bot will be ready to serve your clients!</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6">
                        <p class="text-blue-800 font-semibold mb-2">
                            <span class="lang-pt">Enquanto isso, fique de olho no Telegram! üì±</span>
                            <span class="lang-en hidden">Meanwhile, keep an eye on Telegram! üì±</span>
                        </p>
                        <p class="text-blue-700 text-sm">
                            <span class="lang-pt">Seu bot:</span>
                            <span class="lang-en hidden">Your bot:</span>
                            <a href="#" id="botLink" class="font-mono font-semibold hover:underline">@yourbot</a>
                        </p>
                    </div>

                    <div class="text-center border-t pt-6">
                        <p class="text-gray-600">
                            <span class="lang-pt">D√∫vidas?</span>
                            <span class="lang-en hidden">Questions?</span>
                        </p>
                        <a href="mailto:hello@botnursery.ai" class="text-purple-600 hover:underline font-semibold">
                            hello@botnursery.ai
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Configuration
        const API_URL = 'https://api.botnursery.ai/onboard';
        
        // State
        let currentStep = 1;
        let currentLang = 'pt';
        let formData = {
            plan: null,
            name: '',
            profession: '',
            otherProfession: '',
            registration: '',
            email: '',
            phone: '',
            country: '',
            telegramId: '',
            botToken: '',
            botUsername: '',
            botName: '',
            agreementSigned: false,
            timestamp: null
        };

        // URL Parameters pre-fill
        function loadUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            let hasParams = false;
            let filledFields = [];

            // Read parameters
            if (urlParams.has('name')) {
                formData.name = urlParams.get('name');
                hasParams = true;
                filledFields.push('name');
            }
            if (urlParams.has('email')) {
                formData.email = urlParams.get('email');
                hasParams = true;
                filledFields.push('email');
            }
            if (urlParams.has('profession')) {
                const prof = urlParams.get('profession');
                const professionSelect = document.getElementById('profession');
                // Try to match to existing options
                const matchedOption = Array.from(professionSelect.options).find(opt => 
                    opt.value.toLowerCase() === prof.toLowerCase() || 
                    opt.textContent.toLowerCase().includes(prof.toLowerCase())
                );
                if (matchedOption) {
                    formData.profession = matchedOption.value;
                } else {
                    formData.profession = 'outro';
                    formData.otherProfession = prof;
                }
                hasParams = true;
                filledFields.push('profession');
            }
            if (urlParams.has('phone')) {
                formData.phone = urlParams.get('phone');
                hasParams = true;
                filledFields.push('phone');
            }
            if (urlParams.has('telegram')) {
                formData.telegramId = urlParams.get('telegram');
                hasParams = true;
                filledFields.push('telegram');
            }
            if (urlParams.has('lang')) {
                const lang = urlParams.get('lang');
                if (lang === 'en' || lang === 'pt') {
                    currentLang = lang;
                }
            }

            // Show banner if params present
            if (hasParams) {
                document.getElementById('prefillBanner').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('prefillBanner').classList.add('hidden');
                }, 5000);
            }

            // Auto-advance if step 2 is complete (only from URL params, not localStorage)
            if (filledFields.includes('name') && filledFields.includes('email') && filledFields.includes('profession')) {
                window._autoAdvanceFromUrl = true;
            }
        }

        // Load saved progress
        const savedData = localStorage.getItem('botnursery_onboarding');
        if (savedData) {
            try {
                const parsed = JSON.parse(savedData);
                formData = { ...formData, ...parsed };
            } catch (e) {
                console.error('Failed to parse saved data:', e);
            }
        }

        // Load URL params (override saved data)
        loadUrlParameters();

        // Handle Stripe return
        (function handleStripeReturn() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('success') === 'true') {
                // Payment successful ‚Äî show success screen
                // Clean URL
                window.history.replaceState({}, '', window.location.pathname);
                // Load saved formData for bot link
                const saved = localStorage.getItem('botnursery_onboarding');
                if (saved) {
                    try { formData = { ...formData, ...JSON.parse(saved) }; } catch(e) {}
                }
                setTimeout(() => {
                    if (formData.botUsername) {
                        document.getElementById('botLink').textContent = formData.botUsername;
                        document.getElementById('botLink').href = `https://t.me/${formData.botUsername.replace('@', '')}`;
                    }
                    goToStep(7);
                    createConfetti();
                    localStorage.removeItem('botnursery_onboarding');
                }, 100);
                return;
            }
            if (urlParams.get('canceled') === 'true') {
                // User canceled Stripe ‚Äî go back to agreement step
                window.history.replaceState({}, '', window.location.pathname);
                setTimeout(() => goToStep(6), 100);
            }
        })();

        // Language toggle
        document.getElementById('langToggle').addEventListener('click', () => {
            currentLang = currentLang === 'pt' ? 'en' : 'pt';
            updateLanguage();
        });

        function updateLanguage() {
            document.querySelectorAll('.lang-pt').forEach(el => {
                el.classList.toggle('hidden', currentLang !== 'pt');
            });
            document.querySelectorAll('.lang-en').forEach(el => {
                el.classList.toggle('hidden', currentLang !== 'en');
            });
            document.getElementById('langToggle').innerHTML = currentLang === 'pt' ? 'üá¨üáß English' : 'üáßüá∑ Portugu√™s';
        }

        // Pricing modal functions
        function openPricingModal() {
            document.getElementById('pricingModal').classList.add('show');
        }

        function closePricingModal() {
            document.getElementById('pricingModal').classList.remove('show');
        }

        // Close modal on background click
        document.getElementById('pricingModal').addEventListener('click', (e) => {
            if (e.target.id === 'pricingModal') {
                closePricingModal();
            }
        });

        // Agreement modal functions
        function openAgreementModal() {
            document.getElementById('agreementModal').classList.add('show');
            updateLanguage(); // ensure modal content matches current lang
        }

        function closeAgreementModal() {
            document.getElementById('agreementModal').classList.remove('show');
        }

        document.getElementById('agreementModal').addEventListener('click', (e) => {
            if (e.target.id === 'agreementModal') {
                closeAgreementModal();
            }
        });

        // Navigation ‚Äî debounce to prevent click-through on overlapping buttons
        let _navLock = false;
        function goToStep(step) {
            if (_navLock) return;
            _navLock = true;
            setTimeout(() => _navLock = false, 300);
            // Hide all steps
            for (let i = 1; i <= 7; i++) {
                document.getElementById(`step${i}`).classList.add('hidden');
            }
            
            // Show current step
            document.getElementById(`step${step}`).classList.remove('hidden');
            currentStep = step;
            
            // Map internal steps to display steps (3 is skipped, user sees 1,2,4,5,6 as steps 1-5, 7=done)
            const displayMap = {1:1, 2:2, 4:3, 5:4, 6:5, 7:6};
            const displayStep = displayMap[step] || step;
            const totalSteps = 6;
            
            // Update progress bar
            const progress = (displayStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Update progress text
            document.querySelector('#progressText .lang-pt').textContent = `Passo ${displayStep} de ${totalSteps}`;
            document.querySelector('#progressText .lang-en').textContent = `Step ${displayStep} of ${totalSteps}`;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Update checkout summary on step 3
            if (step === 3) updateCheckoutSummary();

            // Save progress
            saveProgress();

            // Auto-advance step 2 if filled from URL params (not localStorage)
            if (step === 2 && window._autoAdvanceFromUrl) {
                window._autoAdvanceFromUrl = false;
                setTimeout(() => {
                    if (formData.name && formData.profession && formData.email) {
                        goToStep(4);
                    }
                }, 500);
            }
        }

        function saveProgress() {
            localStorage.setItem('botnursery_onboarding', JSON.stringify(formData));
        }

        // Back buttons
        // Back navigation ‚Äî skip step 3 (old payment, now unused)
        const backMap = {2:1, 4:2, 5:4, 6:5};
        document.querySelectorAll('.step-back').forEach(btn => {
            btn.addEventListener('click', () => {
                const prev = backMap[currentStep] || (currentStep > 1 ? currentStep - 1 : 1);
                goToStep(prev);
            });
        });

        // Step 1: Plan selection
        document.querySelectorAll('.plan-select').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const plan = e.target.dataset.plan || e.target.closest('.plan-select').dataset.plan;
                formData.plan = plan;
                
                // Visual feedback
                document.querySelectorAll('.plan-card').forEach(card => {
                    card.classList.remove('selected');
                });
                document.querySelector(`.plan-card[data-plan="${plan}"]`).classList.add('selected');
                
                // Enable next button
                document.getElementById('step1Next').disabled = false;
                
                saveProgress();
            });
        });

        // Restore plan selection
        if (formData.plan) {
            document.querySelector(`.plan-card[data-plan="${formData.plan}"]`)?.classList.add('selected');
            document.getElementById('step1Next').disabled = false;
        }

        document.getElementById('step1Next').addEventListener('click', () => {
            if (formData.plan) {
                goToStep(2);
            }
        });

        // Step 2: Information form
        const step2Fields = ['fullName', 'profession', 'email', 'country'];
        
        // Restore form values
        if (formData.name) document.getElementById('fullName').value = formData.name;
        if (formData.profession) {
            document.getElementById('profession').value = formData.profession;
            if (formData.profession === 'outro') {
                document.getElementById('otherProfessionDiv').classList.remove('hidden');
                document.getElementById('otherProfession').value = formData.otherProfession || '';
            }
        }
        if (formData.registration) document.getElementById('registration').value = formData.registration;
        if (formData.email) document.getElementById('email').value = formData.email;
        if (formData.phone) document.getElementById('phone').value = formData.phone;
        if (formData.country) document.getElementById('country').value = formData.country;

        document.getElementById('profession').addEventListener('change', (e) => {
            const otherDiv = document.getElementById('otherProfessionDiv');
            if (e.target.value === 'outro') {
                otherDiv.classList.remove('hidden');
            } else {
                otherDiv.classList.add('hidden');
            }
        });

        document.getElementById('step2Next').addEventListener('click', () => {
            formData.name = document.getElementById('fullName').value.trim();
            formData.profession = document.getElementById('profession').value;
            formData.otherProfession = document.getElementById('otherProfession').value.trim();
            formData.registration = document.getElementById('registration').value.trim();
            formData.email = document.getElementById('email').value.trim();
            formData.phone = document.getElementById('phone').value.trim();
            formData.country = document.getElementById('country').value;
            
            // Validation
            if (!formData.name || !formData.profession || !formData.email || !formData.country) {
                alert(currentLang === 'pt' ? 'Por favor, preencha todos os campos obrigat√≥rios.' : 'Please fill in all required fields.');
                return;
            }
            
            if (!formData.email.includes('@')) {
                alert(currentLang === 'pt' ? 'Email inv√°lido.' : 'Invalid email.');
                return;
            }
            
            saveProgress();
            goToStep(4);
        });

        // Step 3: Payment (now handled at end via Stripe Checkout ‚Äî step is skipped)
        // Old card form elements removed ‚Äî no restore needed

        // Update checkout plan summary when reaching step 3
        function updateCheckoutSummary() {
            const nameEl = document.getElementById('checkoutPlanName');
            const priceEl = document.getElementById('checkoutPlanPrice');
            const isBR = formData.country === 'BR' || currentLang === 'pt';
            if (formData.plan === 'founding') {
                nameEl.innerHTML = currentLang === 'pt' ? 'üåü Plano Fundador' : 'üåü Founding Practitioner';
                priceEl.textContent = isBR ? 'R$149/m√™s + R$25 por paciente ativo' : '$29/mo + $5 per active patient';
            } else {
                nameEl.innerHTML = currentLang === 'pt' ? 'ü§ñ Plano Inicial' : 'ü§ñ Starter Plan';
                priceEl.textContent = isBR ? 'R$149/m√™s + R$25 por paciente ativo' : '$29/mo + $5 per active patient';
            }
        }

        document.getElementById('step3Next').addEventListener('click', async () => {
            const btn = document.getElementById('step3Next');
            const loading = document.getElementById('checkoutLoading');
            btn.classList.add('hidden');
            loading.classList.remove('hidden');

            try {
                const response = await fetch('https://api.botnursery.ai/create-checkout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: formData.name,
                        email: formData.email,
                        profession: formData.profession === 'outro' ? formData.otherProfession : formData.profession,
                        registration: formData.registration,
                        phone: formData.phone,
                        country: formData.country,
                        plan: formData.plan,
                        telegramId: formData.telegramId,
                        botToken: formData.botToken,
                        botUsername: formData.botUsername,
                        botName: formData.botName,
                        lang: currentLang,
                        agreementVersion: '2026-02-20-v1',
                        agreementSignedAt: formData.timestamp || new Date().toISOString(),
                    })
                });

                const data = await response.json();
                if (data.url) {
                    // Save progress before redirecting
                    saveProgress();
                    window.location.href = data.url;
                } else {
                    throw new Error(data.error || 'Failed to create checkout');
                }
            } catch (err) {
                console.error('Checkout error:', err);
                alert(currentLang === 'pt'
                    ? 'Erro ao conectar com o sistema de pagamento. Tente novamente.'
                    : 'Error connecting to payment system. Please try again.');
                btn.classList.remove('hidden');
                loading.classList.add('hidden');
            }
        });

        // Step 4: Telegram setup
        let telegramIdEntered = false;

        document.getElementById('hasTelegram').addEventListener('click', () => {
            document.getElementById('step4a').classList.add('hidden');
            document.getElementById('step4b').classList.remove('hidden');
            document.getElementById('step4Next').classList.remove('hidden');
        });

        document.getElementById('noTelegram').addEventListener('click', () => {
            document.getElementById('telegramDownload').classList.remove('hidden');
            // Also show the ID input and Next button so user can proceed
            document.getElementById('step4b').classList.remove('hidden');
            document.getElementById('step4Next').classList.remove('hidden');
        });

        document.getElementById('downloadedTelegram').addEventListener('click', () => {
            document.getElementById('step4a').classList.add('hidden');
            document.getElementById('telegramDownload').classList.add('hidden');
            document.getElementById('step4b').classList.remove('hidden');
            document.getElementById('step4Next').classList.remove('hidden');
        });

        // Restore Telegram ID
        if (formData.telegramId) {
            document.getElementById('telegramId').value = formData.telegramId;
        }

        // Parse @userinfobot response
        document.getElementById('userinfoResponse').addEventListener('input', (e) => {
            const text = e.target.value;
            const idMatch = text.match(/Id:\s*(\d+)/i);
            if (idMatch) {
                document.getElementById('telegramId').value = idMatch[1];
                document.getElementById('parsedTelegramId').classList.remove('hidden');
                document.getElementById('parsedTelegramIdValue').textContent = idMatch[1];
            } else {
                document.getElementById('parsedTelegramId').classList.add('hidden');
            }
        });

        document.getElementById('step4Next').addEventListener('click', () => {
            formData.telegramId = document.getElementById('telegramId').value.trim();
            
            if (!formData.telegramId || !/^\d+$/.test(formData.telegramId)) {
                alert(currentLang === 'pt' ? 'Por favor, insira um Telegram ID v√°lido (apenas n√∫meros).' : 'Please enter a valid Telegram ID (numbers only).');
                return;
            }
            
            saveProgress();
            goToStep(5);
        });

        // Step 5: BotFather message auto-parse
        document.getElementById('botfatherMessage').addEventListener('input', (e) => {
            const message = e.target.value;
            
            // Try to parse token
            const tokenMatch = message.match(/(\d+:[A-Za-z0-9_-]+)/);
            
            // Try to parse username
            const usernameMatch = message.match(/t\.me\/(\w+Bot)|@(\w+Bot)/i);
            
            // Try to parse bot name from username (remove trailing "Bot" and split camelCase)
            let botName = '';
            if (usernameMatch) {
                const rawUsername = usernameMatch[1] || usernameMatch[2];
                // Remove trailing "Bot" and split camelCase/underscores into words
                botName = rawUsername
                    .replace(/Bot$/i, '')
                    .replace(/_/g, ' ')
                    .replace(/([a-z])([A-Z])/g, '$1 $2')
                    .trim();
            }
            
            // Show parsed results
            const parsedResults = document.getElementById('parsedResults');
            const manualFields = document.getElementById('manualFields');
            
            if (tokenMatch || usernameMatch) {
                parsedResults.classList.remove('hidden');
                
                if (tokenMatch) {
                    const token = tokenMatch[1];
                    document.getElementById('parsedToken').classList.remove('hidden');
                    document.getElementById('parsedTokenValue').textContent = token.substring(0, 20) + '...';
                    document.getElementById('botToken').value = token;
                }
                
                if (usernameMatch) {
                    const username = usernameMatch[1] || usernameMatch[2];
                    document.getElementById('parsedUsername').classList.remove('hidden');
                    document.getElementById('parsedUsernameValue').textContent = '@' + username;
                    document.getElementById('botUsername').value = '@' + username;
                }
                
                if (botName) {
                    document.getElementById('parsedName').classList.remove('hidden');
                    document.getElementById('parsedNameValue').textContent = botName;
                    document.getElementById('botName').value = botName;
                }
                
                // Hide manual fields if parsing succeeded
                manualFields.classList.add('hidden');
            } else if (message.length > 50) {
                // Parsing failed, show manual option
                parsedResults.classList.add('hidden');
                manualFields.classList.remove('hidden');
            }
        });

        // Manual fields toggle
        document.getElementById('showManualFields')?.addEventListener('click', () => {
            document.getElementById('manualInputs').classList.toggle('hidden');
        });

        // Restore bot values
        if (formData.botToken) {
            document.getElementById('botToken').value = formData.botToken;
            // Could also populate the textarea with a reconstructed message, but not essential
        }
        if (formData.botUsername) document.getElementById('botUsername').value = formData.botUsername;
        if (formData.botName) document.getElementById('botName').value = formData.botName;

        document.getElementById('step5Next').addEventListener('click', () => {
            // Get values from either parsed hidden fields or manual inputs
            let token = document.getElementById('botToken').value.trim();
            let username = document.getElementById('botUsername').value.trim();
            let name = document.getElementById('botName').value.trim();
            
            // Fallback to manual inputs if hidden fields empty
            if (!token) token = document.getElementById('botTokenManual')?.value.trim() || '';
            if (!username) username = document.getElementById('botUsernameManual')?.value.trim() || '';
            if (!name) name = document.getElementById('botNameManual')?.value.trim() || '';
            
            formData.botToken = token;
            formData.botUsername = username;
            formData.botName = name;
            
            // Validation
            if (!formData.botToken || !formData.botUsername || !formData.botName) {
                alert(currentLang === 'pt' ? 'Por favor, preencha todos os campos do bot ou cole a mensagem completa do BotFather.' : 'Please fill in all bot fields or paste the complete BotFather message.');
                return;
            }
            
            if (!formData.botToken.match(/^\d+:[A-Za-z0-9_-]+$/)) {
                alert(currentLang === 'pt' ? 'Token inv√°lido. Formato esperado: n√∫meros:letras' : 'Invalid token. Expected format: numbers:letters');
                return;
            }
            
            if (!formData.botUsername.startsWith('@')) {
                formData.botUsername = '@' + formData.botUsername;
            }
            
            saveProgress();
            goToStep(6);
        });

        // Step 6: Agreement
        document.getElementById('agreementCheck').addEventListener('change', (e) => {
            document.getElementById('step6Next').disabled = !e.target.checked;
        });

        document.getElementById('step6Next').addEventListener('click', async () => {
            if (!document.getElementById('agreementCheck').checked) {
                return;
            }
            
            formData.agreementSigned = true;
            formData.timestamp = new Date().toISOString();
            
            // Show loading
            document.getElementById('step6Next').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
            
            try {
                // Capture agreement text for versioning
                const agreementText = document.getElementById('agreementFullText')?.innerText || '';

                // Step 1: Save onboard data
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: formData.name,
                        profession: formData.profession === 'outro' ? formData.otherProfession : formData.profession,
                        registration: formData.registration,
                        email: formData.email,
                        phone: formData.phone,
                        country: formData.country,
                        plan: formData.plan,
                        telegramId: formData.telegramId,
                        botToken: formData.botToken,
                        botUsername: formData.botUsername,
                        botName: formData.botName,
                        agreementSigned: true,
                        agreementVersion: '2026-02-20-v1',
                        agreementText: agreementText,
                        agreementSignedAt: formData.timestamp,
                        agreementLanguage: currentLang,
                        timestamp: formData.timestamp
                    })
                });

                // Step 2: Create Stripe Checkout session and redirect
                const checkoutResponse = await fetch('https://api.botnursery.ai/create-checkout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: formData.name,
                        email: formData.email,
                        profession: formData.profession === 'outro' ? formData.otherProfession : formData.profession,
                        registration: formData.registration,
                        phone: formData.phone,
                        country: formData.country,
                        plan: formData.plan,
                        telegramId: formData.telegramId,
                        botToken: formData.botToken,
                        botUsername: formData.botUsername,
                        botName: formData.botName,
                        lang: currentLang,
                        agreementVersion: '2026-02-20-v1',
                        agreementSignedAt: formData.timestamp,
                    })
                });

                const checkoutData = await checkoutResponse.json();
                if (checkoutData.url) {
                    saveProgress();
                    window.location.href = checkoutData.url;
                } else {
                    throw new Error(checkoutData.error || 'Failed to create checkout');
                }
                
            } catch (error) {
                console.error('Submission error:', error);
                
                // Show error
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('errorState').classList.remove('hidden');
                document.getElementById('errorMessage').textContent = currentLang === 'pt' 
                    ? 'Erro ao conectar com o sistema de pagamento. Por favor, tente novamente.'
                    : 'Error connecting to payment system. Please try again.';
                
                document.getElementById('step6Next').classList.remove('hidden');
            }
        });

        document.getElementById('retryButton')?.addEventListener('click', () => {
            document.getElementById('errorState').classList.add('hidden');
            document.getElementById('step6Next').classList.remove('hidden');
        });

        // Confetti animation
        function createConfetti() {
            const colors = ['#f59e0b', '#8b5cf6', '#ec4899', '#3b82f6', '#10b981'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti-piece';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 50);
            }
        }

        /**
         * Generate onboarding URL with pre-filled data
         * This function is called by the sales bot to create redirect links
         * @param {Object} data - {name, email, profession, phone, telegram}
         * @returns {string} Full onboarding URL with query parameters
         */
        function generateOnboardingUrl(data) {
            const baseUrl = window.location.origin + window.location.pathname;
            const params = new URLSearchParams();
            
            if (data.name) params.set('name', data.name);
            if (data.email) params.set('email', data.email);
            if (data.profession) params.set('profession', data.profession);
            if (data.phone) params.set('phone', data.phone);
            if (data.telegram) params.set('telegram', data.telegram);
            if (data.lang) params.set('lang', data.lang);
            
            return `${baseUrl}?${params.toString()}`;
        }

        // Initialize
        updateLanguage();
    </script>
</body>
</html>
